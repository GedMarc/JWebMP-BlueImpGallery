(function(a){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery"],a)}else{a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}})(function(b,c){b.extend(c.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var a=c.prototype.handleSlide;b.extend(c.prototype,{handleSlide:function(d){a.call(this,d);if(this.playingVideo){this.playingVideo.pause()}},videoFactory:function(p,j,q){var l=this;var g=this.options;var r=this.elementPrototype.cloneNode(false);var f=b(r);var n=[{type:"error",target:r}];var u=q||document.createElement("video");var i=this.getItemProperty(p,g.urlProperty);var h=this.getItemProperty(p,g.typeProperty);var w=this.getItemProperty(p,g.titleProperty);var k=this.getItemProperty(p,this.options.altTextProperty)||w;var v=this.getItemProperty(p,g.videoPosterProperty);var o;var e=this.getItemProperty(p,g.videoSourcesProperty);var s;var m;var t;var d;f.addClass(g.videoContentClass);if(w){r.title=w}if(u.canPlayType){if(i&&h&&u.canPlayType(h)){u.src=i}else{if(e){while(e.length){s=e.shift();i=this.getItemProperty(s,g.urlProperty);h=this.getItemProperty(s,g.typeProperty);if(i&&h&&u.canPlayType(h)){u.src=i;break}}}}}if(v){u.poster=v;o=this.imagePrototype.cloneNode(false);b(o).addClass(g.toggleClass);o.src=v;o.draggable=false;o.alt=k;r.appendChild(o)}m=document.createElement("a");m.setAttribute("target","_blank");if(!q){m.setAttribute("download",w)}m.href=i;if(u.src){u.controls=true;(q||b(u)).on("error",function(){l.setTimeout(j,n)}).on("pause",function(){if(u.seeking){return}t=false;f.removeClass(l.options.videoLoadingClass).removeClass(l.options.videoPlayingClass);if(d){l.container.addClass(l.options.controlsClass)}delete l.playingVideo;if(l.interval){l.play()}}).on("playing",function(){t=false;f.removeClass(l.options.videoLoadingClass).addClass(l.options.videoPlayingClass);if(l.container.hasClass(l.options.controlsClass)){d=true;l.container.removeClass(l.options.controlsClass)}else{d=false}}).on("play",function(){window.clearTimeout(l.timeout);t=true;f.addClass(l.options.videoLoadingClass);l.playingVideo=u});b(m).on("click",function(x){l.preventDefault(x);if(t){u.pause()}else{u.play()}});r.appendChild((q&&q.element)||u)}r.appendChild(m);this.setTimeout(j,[{type:"load",target:r}]);return r}});return c});